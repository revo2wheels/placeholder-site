<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pipeline Architecture â€” Current vs Future | Coach GPT App</title>
  <link rel="icon" type="image/png" href="https://avatars.githubusercontent.com/u/44225520?v=4" />
  <link rel="stylesheet" href="assets/css/style.css?v=1.7">
</head>

<body>
  <!-- ===================================================
  ğŸ§­ HEADER
  ==================================================== -->
  <header>
    <h1>
      <img src="https://avatars.githubusercontent.com/u/44225520?v=4" alt="App Icon" />
      <a href="https://www.cliveking.net">Coach GPT App</a>
    </h1>
    <nav>
      <a href="https://www.cliveking.net#about">About</a>
      <a href="https://www.cliveking.net#features">Features</a>
      <a href="https://www.cliveking.net#Reports">Reports</a>
      <a href="https://www.cliveking.net#Questions">Questions</a>
      <a href="https://www.cliveking.net#samples">Samples</a>
      <a href="https://www.cliveking.net#coach">Coach</a>
      <a href="https://www.cliveking.net#download">Download</a>
      <a href="https://www.cliveking.net#contact">Contact</a>
      <a href="https://www.cliveking.net/pipeline.html" style="font-weight:bold;color:#38bdf8;">DESIGN</a>
    </nav>
  </header>

  <!-- ===================================================
  ğŸ“˜ MAIN CONTENT
  ==================================================== -->
  <main>
    <section class="card">
      <h1>System Architecture â€” Current</h1>
      <p style="text-align:center;max-width:700px;margin:0 auto 2rem;">
        This document outlines the current operational design for the <strong>Coach GPT App</strong>,
        the guarantees provided by its architecture, and the roadmap for the next-generation
        Intervals.icu AI Coaching Pipeline.
      </p>
    </section>

    <!-- ===================================================
    âš™ï¸ CURRENT ARCHITECTURE
    ==================================================== -->
<section class="card">
  <h2>âš™ï¸ Current Architecture</h2>
  <div class="codeblock" style="font-family:'Courier New',monospace;font-size:0.9rem;overflow-x:auto;text-align:center;">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ChatGPT App       â”‚
â”‚  (UI + tool invocation)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ HTTPS tool call
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cloudflare Worker      â”‚
â”‚  â€¢ Auth proxy only       â”‚
â”‚  â€¢ No computation        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Railway FastAPI Backend          â”‚
â”‚  â€¢ Tier-0 fetch (activities/wellness)
â”‚  â€¢ Tier-1 normalization + snapshots â”‚
â”‚  â€¢ Tier-2 enforced totals + audits  â”‚
â”‚  â€¢ Semantic JSON (URF v5.1)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Intervals.icu API    â”‚
â”‚  (Authoritative source)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
  </div>
</section>


    <!-- ===================================================
    ğŸ§© ARCHITECTURE GUARANTEES
    ==================================================== -->
    <section class="card">
      <h2>ğŸ§© Current Architecture Guarantees</h2>
      <table>
        <thead>
          <tr><th>Area</th><th>Implementation</th><th>Result</th></tr>
        </thead>
        <tbody>
          <tr><td>Execution Model</td><td>Real Python execution on Railway (FastAPI)</td><td>Deterministic, reproducible results</td></tr>
          <tr><td>Cloudflare Role</td><td>Auth + request proxy only (no computation)</td><td>No payload mutation or logic drift</td></tr>
          <tr><td>Data Fetch</td><td>Tier-0 authenticated ICU fetch with fixed windows</td><td>Stable datasets and predictable scope</td></tr>
          <tr><td>Audit Pipeline</td><td>Tier-0 â†’ Tier-1 â†’ Tier-2 enforced validation</td><td>Totals locked; variance explicitly checked</td></tr>
          <tr><td>Totals Authority</td><td>Tier-2 hard-enforced event-only totals</td><td>No weekly bleed into season or summary reports</td></tr>
          <tr><td>Serialization</td><td>Single-pass JSON (no base64, no double encoding)</td><td>No numeric precision loss</td></tr>
          <tr><td>State Handling</td><td>Context preserved across Tier boundaries</td><td>No redundant ICU fetches</td></tr>
          <tr><td>Schema Control</td><td>Unified Reporting Framework (URF v5.1)</td><td>Explicit contracts between pipeline stages</td></tr>
          <tr><td>Observability</td><td>Structured logs at each Tier boundary</td><td>Full traceability of audit decisions</td></tr>
        </tbody>
      </table>
    </section>

    <!-- ===================================================
    ğŸ“ DESIGN PRINCIPLES
    ==================================================== -->
    <section class="card">
      <h2>ğŸ“ Design Principles</h2>
      <table>
        <thead>
          <tr><th>Principle</th><th>Meaning in Practice</th></tr>
        </thead>
        <tbody>
          <tr><td>Determinism</td><td>All metrics are computed once, audited, and reused without recomputation.</td></tr>
          <tr><td>Separation of Concerns</td><td>Edge handles auth and routing; backend handles computation and audits.</td></tr>
          <tr><td>Auditability</td><td>Every report can be traced back to Tier-0 source data.</td></tr>
          <tr><td>Schema Stability</td><td>URF contracts prevent silent field drift between versions.</td></tr>
          <tr><td>Numerical Integrity</td><td>No virtual math, inference, or approximation; all values are explicit.</td></tr>
        </tbody>
      </table>
    </section>

    <!-- ===================================================
    ğŸš€ FUTURE PIPELINE
    ==================================================== -->
    <section class="card">
      <h2>ğŸš€ Future Pipeline Extensions</h2>
      <ul>
        <li>Extend reporting to full-season and 365-day longitudinal datasets.</li>
        <li>Convert action recommendations to calendar events directly in Intervals.icu, and read planned Calendar events to update actions</li>
        <li>Generate downloadable workout files (e.g., ZWO) and push to Intervals libraries via chat commands.</li>
        <li>Integrate adaptive load simulation for predictive season modeling.</li>
      </ul>
    </section>
  </main>

  <!-- ===================================================
  âš« FOOTER
  ==================================================== -->
  <footer>
    <p>&copy; 2025 <a href="https://www.cliveking.net">Clive King</a> Â· Coach GPT App â€” Unified Pipeline Architecture</p>
  </footer>
</body>
</html>
