<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pipeline Architecture â€” Unified Prefetch Design | Coach GPT App</title>
  <link rel="icon" type="image/png" href="https://avatars.githubusercontent.com/u/44225520?v=4" />
  <link rel="stylesheet" href="assets/css/style.css?v=1.8">
</head>

<body>
  <!-- ===================================================
  ğŸ§­ HEADER
  ==================================================== -->
  <header>
    <h1>
      <img src="https://avatars.githubusercontent.com/u/44225520?v=4" alt="App Icon" />
      <a href="https://www.cliveking.net">Coach GPT App</a>
    </h1>
    <nav>
      <a href="https://www.cliveking.net#about">About</a>
      <a href="https://www.cliveking.net#features">Features</a>
      <a href="https://www.cliveking.net#Reports">Reports</a>
      <a href="https://www.cliveking.net#Questions">Questions</a>
      <a href="https://www.cliveking.net#samples">Samples</a>
      <a href="https://www.cliveking.net#coach">Coach</a>
      <a href="https://www.cliveking.net#download">Download</a>
      <a href="https://www.cliveking.net#contact">Contact</a>
      <a href="https://www.cliveking.net/changelog.html">CHANGELOG</a>
      <a href="https://www.cliveking.net/pipeline.html" style="font-weight:bold;color:#38bdf8;">DESIGN</a>
    </nav>
  </header>

  <main>
    <!-- ===================================================
    âš™ï¸ CURRENT PIPELINE
    ==================================================== -->
    <section class="card">
      <h1>Unified Prefetch Architecture â€” v5.1 Design</h1>
      <p style="text-align:center;max-width:750px;margin:0 auto 2rem;">
        The <strong>Coach GPT App</strong> now runs on a unified prefetch architecture that separates
        <em>data retrieval</em>, <em>normalization</em>, and <em>semantic report generation</em>
        across Cloudflare and Railway.  
        This ensures deterministic output, fixed schema contracts, and verifiable data lineage from <strong>Intervals.icu</strong>.
      </p>
    </section>

    <section class="card">
      <h2>âš™ï¸ Current Operational Pipeline</h2>
      <div class="codeblock" style="font-family:'Courier New',monospace;font-size:0.9rem;overflow-x:auto;text-align:center;">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ChatGPT / CLI App     â”‚
â”‚  (Tool invocation layer)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚  HTTPS tool call
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸŒ©ï¸ Cloudflare Worker (Edge)          â”‚
â”‚  â€¢ Auth + routing proxy                     â”‚
â”‚  â€¢ Handles ?start/?end normalization         â”‚
â”‚  â€¢ Prefetches Intervals data â†’ JSON context  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ğŸš‰ Railway Backend (FastAPI)           â”‚
â”‚  â€¢ Tier-0: Prefetch normalization             â”‚
â”‚     - DataFrame coercion + baseline columns   â”‚
â”‚     - Empty-source detection + AuditHalt      â”‚
â”‚  â€¢ Tier-1: Activity & wellness validation     â”‚
â”‚     - moving_time filtering, zero-checks      â”‚
â”‚  â€¢ Tier-2: Aggregation + enforcement          â”‚
â”‚     - Totals reconciliation, variance checks  â”‚
â”‚  â€¢ Outputs URF v5.1 Semantic JSON             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Intervals.icu API        â”‚
â”‚   (authoritative source)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
      </div>
      <p style="text-align:center;margin-top:1rem;">
        ğŸ”„ Cloudflare handles authentication, routing, and optional synthetic testing.<br>
        ğŸš‰ Railway performs full computation, validation, and serialization.
      </p>
    </section>

    <!-- ===================================================
    ğŸ§© PIPELINE GUARANTEES
    ==================================================== -->
    <section class="card">
      <h2>ğŸ§© Architecture Guarantees</h2>
      <table>
        <thead>
          <tr><th>Area</th><th>Implementation</th><th>Guarantee</th></tr>
        </thead>
        <tbody>
          <tr><td>Prefetch Flow</td><td>Cloudflare normalizes date params and injects optional test payloads</td><td>Safe staging tests without real data</td></tr>
          <tr><td>Execution Model</td><td>Python execution on Railway (FastAPI + Pandas)</td><td>Deterministic, audited output</td></tr>
          <tr><td>Tier-0 Validation</td><td>Baseline column checks (`moving_time`, `distance`, etc.)</td><td>No schema drift or missing fields</td></tr>
          <tr><td>Tier-1 Audit</td><td>Filters invalid / null activities, computes daily summaries</td><td>Enforced numeric consistency</td></tr>
          <tr><td>Tier-2 Enforcement</td><td>Lock totals, enforce logical consistency</td><td>No variance bleed between scopes</td></tr>
          <tr><td>Serialization</td><td>Single-pass semantic JSON (no float loss)</td><td>Stable numeric precision</td></tr>
          <tr><td>Observability</td><td>Structured logs at all Tier boundaries</td><td>Traceable audit chain (lightâ†’fullâ†’wellness)</td></tr>
          <tr><td>Schema Version</td><td>URF v5.1 unified contracts</td><td>Cross-version compatibility with GPT tool API</td></tr>
        </tbody>
      </table>
    </section>

  <footer>
    <p>&copy; 2026 <a href="https://www.cliveking.net">Clive King</a> Â· Coach GPT App â€” Unified Prefetch Architecture</p>
  </footer>
</body>
</html>
